# Story 1.2: 이메일/비밀번호 로그인

## Status

Ready for Development

## 📋 요약

이메일/비밀번호 로그인 기능을 구현하여 등록된 사용자가 AI 메모장 서비스에 접근할 수 있도록 합니다. Story 1.1에서 구축한 인프라를 활용하여 로그인 폼, 인증 로직, 그리고 사용자 경험을 완성합니다.

**스토리 포인트:** 3점
**예상 소요 시간:** 1-2일

## Story

**As a** 등록된 사용자,
**I want** 이메일과 비밀번호로 로그인할 수 있는 기능,
**so that** 내 계정에 접근하여 AI 메모장 서비스를 이용할 수 있다.

## Acceptance Criteria

1. 이메일 주소와 비밀번호 입력 필드가 있는 로그인 폼이 제공되어야 한다
2. 이메일 형식 검증이 클라이언트 사이드에서 이루어져야 한다
3. 잘못된 이메일 또는 비밀번호 입력 시 적절한 에러 메시지가 표시되어야 한다
4. 이메일 인증이 완료되지 않은 사용자의 경우 인증 안내 메시지가 표시되어야 한다
5. 성공적인 로그인 후 사용자는 홈 페이지로 리다이렉트되어야 한다
6. 이미 로그인된 사용자가 로그인 페이지 접근 시 홈 페이지로 리다이렉트되어야 한다
7. "비밀번호 찾기" 링크가 제공되어야 한다

## Tasks / Subtasks

-   [ ] 로그인 UI 컴포넌트 구현 (AC: 1, 2, 7)
    -   [ ] 로그인 폼 레이아웃 생성 (이메일, 비밀번호 필드)
    -   [ ] 이메일 형식 유효성 검사 로직 구현
    -   [ ] 비밀번호 표시/숨기기 토글 기능
    -   [ ] 비밀번호 찾기 링크 추가
    -   [ ] 로딩 상태 및 에러 상태 UI 처리
-   [ ] Supabase Auth 로그인 연동 (AC: 3, 4, 5)
    -   [ ] signIn 서버 액션 새로 구현
    -   [ ] 이메일 미인증 사용자 처리 로직
    -   [ ] 에러 핸들링 및 사용자 친화적 메시지 매핑
    -   [ ] 로그인 유효성 검사 스키마 추가
-   [ ] 로그인 페이지 구현 (AC: 6)
    -   [ ] `/signin` 라우트 생성
    -   [ ] 이미 로그인된 사용자 접근 제어
    -   [ ] 성공 시 홈 페이지로 리다이렉트
-   [ ] 회원가입 페이지 연동
    -   [ ] 로그인 폼에 회원가입 링크 추가
    -   [ ] 회원가입 폼에서 로그인 페이지로 이동 링크 추가
-   [ ] 테스트 구현
    -   [ ] 로그인 폼 유효성 검사 단위 테스트
    -   [ ] 로그인 플로우 통합 테스트
    -   [ ] 에러 케이스 테스트 (잘못된 인증정보, 미인증 이메일)
    -   [ ] 리다이렉트 로직 테스트

## Dev Notes

### 이전 스토리 인사이트

[Source: Story 1.1 - 완료된 구현 사항]

-   ✅ Supabase 클라이언트 설정 완료 (`lib/supabase.ts`)
-   ✅ 인증 서버 액션 기반 구조 구축 (`lib/actions/auth.ts`)
-   ✅ shadcn/ui 컴포넌트 시스템 도입 (`components/ui/`)
-   ✅ 회원가입 폼 유효성 검사 패턴 확립 (`lib/validations/auth.ts`)
-   ✅ 일관된 에러 핸들링 및 사용자 친화적 메시지 패턴
-   ✅ 온보딩 페이지 구현 (`app/onboarding/page.tsx`)
-   ✅ 환경 변수 설정 완료 (`.env.local`)

### 기술 스택 정보

[Source: docs/architecture.md#1-기술-스택]

-   **프레임워크:** Next.js (App Router, Server Actions)
-   **UI:** shadcn/ui + Tailwind + Radix UI
-   **DB/인증:** Supabase (Postgres, Auth, Storage)

### 보안 요구사항

[Source: docs/architecture.md#3-보안]

-   Supabase 서비스 롤 키는 서버 전용으로 사용
-   사용자 ID 스코프로 권한 제어

### 프로젝트 구조

-   로그인 페이지: `app/signin/page.tsx` (새로 생성)
-   로그인 폼 컴포넌트: `components/auth/signin-form.tsx` (새로 생성)
-   기존 인증 액션 활용: `lib/actions/auth.ts` (signIn 함수 추가 필요)
-   UI 컴포넌트: `components/ui/` 활용 (shadcn/ui 기반, 이미 구현됨)
-   기존 유효성 검사 스키마 확장: `lib/validations/auth.ts`

### Supabase Auth 구성

-   기존 Supabase 설정 활용
-   signInWithPassword 메서드 사용
-   이메일 인증 상태 확인 로직 필요
-   세션 관리는 Supabase SSR이 자동 처리

### 환경 변수 요구사항

[Source: Story 1.1 - 이미 설정 완료]

-   ✅ `NEXT_PUBLIC_SUPABASE_URL`
-   ✅ `NEXT_PUBLIC_SUPABASE_ANON_KEY`
-   ✅ `SUPABASE_SERVICE_ROLE_KEY`
-   ✅ `NEXT_PUBLIC_SITE_URL`

### 재사용 가능한 컴포넌트

-   `components/ui/button.tsx` - 로그인 버튼용
-   `components/ui/input.tsx` - 이메일/비밀번호 입력
-   `components/ui/label.tsx` - 폼 레이블
-   `components/ui/card.tsx` - 로그인 폼 컨테이너

### Testing

#### 테스트 표준

[Source: docs/architecture.md#6-배포운영]

-   테스트 프레임워크: Jest + React Testing Library (추정)
-   테스트 파일 위치: `__tests__/` 또는 컴포넌트 옆에 `.test.tsx`
-   단위 테스트와 통합 테스트 모두 구현
-   Supabase Auth 목킹 필요

## Change Log

| Date       | Version | Description                  | Author           |
| ---------- | ------- | ---------------------------- | ---------------- |
| 2025-09-13 | 1.0     | 스토리 초안 생성             | Scrum Master Bob |
| 2025-09-16 | 1.1     | Story 1.1 완료 반영하여 업데이트 | Scrum Master Bob |

## Dev Agent Record

이 섹션은 개발 에이전트가 구현 중에 채워집니다.

### Agent Model Used

TBD

### Debug Log References

TBD

### Completion Notes List

TBD

### File List

TBD

## QA Results

QA 에이전트가 완료된 스토리 구현을 검토한 결과입니다.
