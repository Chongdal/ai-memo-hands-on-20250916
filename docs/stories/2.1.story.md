# Story 2.1: λ…ΈνΈ μƒμ„± (μ λ© + λ³Έλ¬Έ)

## Status

Ready for Development

## π“‹ μ”μ•½

μ‚¬μ©μκ°€ μ λ©κ³Ό λ³Έλ¬Έμ„ μ…λ ¥ν•μ—¬ μƒλ΅μ΄ λ…ΈνΈλ¥Ό μƒμ„±ν•  μ μλ” κΈ°λ³Έ CRUD κΈ°λ¥μ„ κµ¬ν„ν•©λ‹λ‹¤. μ΄λ” AI λ©”λ¨μ¥μ ν•µμ‹¬ κΈ°λ¥μΌλ΅, μ‚¬μ©μμ μ•„μ΄λ””μ–΄μ™€ μ •λ³΄λ¥Ό μ²΄κ³„μ μΌλ΅ μ €μ¥ν•  μ μλ” κΈ°λ°μ„ μ κ³µν•©λ‹λ‹¤.

**μ¤ν† λ¦¬ ν¬μΈνΈ:** 5μ 
**μμƒ μ†μ” μ‹κ°„:** 2-3μΌ

## Story

**As a** λ΅κ·ΈμΈν• μ‚¬μ©μ,
**I want** μ λ©κ³Ό λ³Έλ¬Έμ„ μ…λ ¥ν•μ—¬ μƒλ΅μ΄ λ…ΈνΈλ¥Ό μƒμ„±ν•  μ μλ” κΈ°λ¥,
**so that** λ‚΄ μ•„μ΄λ””μ–΄μ™€ μ •λ³΄λ¥Ό μ²΄κ³„μ μΌλ΅ κΈ°λ΅ν•κ³  κ΄€λ¦¬ν•  μ μλ‹¤.

## Acceptance Criteria

1. λ…ΈνΈ μƒμ„± νμ΄μ§€μ—μ„ μ λ© μ…λ ¥ ν•„λ“κ°€ μ κ³µλμ–΄μ•Ό ν•λ‹¤
2. λ…ΈνΈ μƒμ„± νμ΄μ§€μ—μ„ λ³Έλ¬Έ μ…λ ¥ ν•„λ“(ν…μ¤νΈ μ—λ¦¬μ–΄)κ°€ μ κ³µλμ–΄μ•Ό ν•λ‹¤
3. μ λ©μ€ ν•„μ μ…λ ¥ ν•­λ©μ΄λ©°, λΉ μ λ©μΌλ΅λ” μ €μ¥ν•  μ μ—†μ–΄μ•Ό ν•λ‹¤
4. λ³Έλ¬Έμ€ μ„ νƒ μ…λ ¥ ν•­λ©μ΄λ©°, λΉ λ³Έλ¬Έλ„ μ €μ¥ κ°€λ¥ν•΄μ•Ό ν•λ‹¤
5. λ…ΈνΈ μ €μ¥ μ‹ μƒμ„±μΌμ‹μ™€ μμ •μΌμ‹κ°€ μλ™μΌλ΅ κΈ°λ΅λμ–΄μ•Ό ν•λ‹¤
6. μ €μ¥λ λ…ΈνΈλ” λ΅κ·ΈμΈν• μ‚¬μ©μλ§ μ ‘κ·Όν•  μ μμ–΄μ•Ό ν•λ‹¤ (RLS μ μ©)
7. μ €μ¥ μ„±κ³µ μ‹ λ…ΈνΈ λ©λ΅ νμ΄μ§€λ΅ λ¦¬λ‹¤μ΄λ ‰νΈλμ–΄μ•Ό ν•λ‹¤
8. μ €μ¥ μ¤‘ λ΅λ”© μƒνƒκ°€ ν‘μ‹λμ–΄μ•Ό ν•λ‹¤
9. μ €μ¥ μ‹¤ν¨ μ‹ μ μ ν• μ—λ¬ λ©”μ‹μ§€κ°€ ν‘μ‹λμ–΄μ•Ό ν•λ‹¤
10. μ·¨μ† λ²„νΌ ν΄λ¦­ μ‹ λ…ΈνΈ λ©λ΅ νμ΄μ§€λ΅ μ΄λ™ν•΄μ•Ό ν•λ‹¤

## Tasks / Subtasks

-   [ ] λ°μ΄ν„°λ² μ΄μ¤ μ¤ν‚¤λ§ μ„¤κ³„ λ° κµ¬ν„ (AC: 5, 6)
    -   [ ] Drizzle ORM μ¤ν‚¤λ§ μ •μ (`lib/db/schema.ts`)
    -   [ ] notes ν…μ΄λΈ” μƒμ„± (id, user_id, title, content, created_at, updated_at)
    -   [ ] RLS μ •μ±… μ„¤μ • (μ‚¬μ©μλ³„ λ°μ΄ν„° κ²©λ¦¬)
    -   [ ] λ°μ΄ν„°λ² μ΄μ¤ λ§μ΄κ·Έλ μ΄μ… μ‹¤ν–‰
-   [ ] λ…ΈνΈ μƒμ„± μ„λ²„ μ•΅μ… κµ¬ν„ (AC: 3, 4, 5, 6, 9)
    -   [ ] createNote μ„λ²„ μ•΅μ… μƒμ„± (`lib/actions/notes.ts`)
    -   [ ] μ λ© ν•„μ κ²€μ¦ λ΅μ§ κµ¬ν„
    -   [ ] μ‚¬μ©μ μΈμ¦ μƒνƒ ν™•μΈ
    -   [ ] λ°μ΄ν„°λ² μ΄μ¤ μ €μ¥ λ΅μ§ κµ¬ν„
    -   [ ] μ—λ¬ ν•Έλ“¤λ§ λ° μ‚¬μ©μ μΉν™”μ  λ©”μ‹μ§€
-   [ ] λ…ΈνΈ μƒμ„± νΌ μ»΄ν¬λ„νΈ κµ¬ν„ (AC: 1, 2, 8, 9)
    -   [ ] μ λ© μ…λ ¥ ν•„λ“ κµ¬ν„
    -   [ ] λ³Έλ¬Έ ν…μ¤νΈ μ—λ¦¬μ–΄ κµ¬ν„ (μλ™ λ†’μ΄ μ΅°μ )
    -   [ ] νΌ μ ν¨μ„± κ²€μ‚¬ (ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“)
    -   [ ] λ΅λ”© μƒνƒ UI κµ¬ν„
    -   [ ] μ—λ¬ μƒνƒ UI κµ¬ν„
    -   [ ] μ €μ¥/μ·¨μ† λ²„νΌ κµ¬ν„
-   [ ] λ…ΈνΈ μƒμ„± νμ΄μ§€ κµ¬ν„ (AC: 7, 10)
    -   [ ] `/notes/new` λΌμ°νΈ μƒμ„±
    -   [ ] μΈμ¦λμ§€ μ•μ€ μ‚¬μ©μ μ ‘κ·Ό μ μ–΄
    -   [ ] μ„±κ³µ μ‹ λ…ΈνΈ λ©λ΅μΌλ΅ λ¦¬λ‹¤μ΄λ ‰νΈ
    -   [ ] μ·¨μ† μ‹ λ…ΈνΈ λ©λ΅μΌλ΅ λ¦¬λ‹¤μ΄λ ‰νΈ
    -   [ ] νμ΄μ§€ λ©”νƒ€λ°μ΄ν„° μ„¤μ •
-   [ ] μ ν¨μ„± κ²€μ‚¬ μ¤ν‚¤λ§ κµ¬ν„
    -   [ ] λ…ΈνΈ μƒμ„± μ¤ν‚¤λ§ μ •μ (`lib/validations/notes.ts`)
    -   [ ] μ λ© κΈΈμ΄ μ ν• (1-200μ)
    -   [ ] λ³Έλ¬Έ κΈΈμ΄ μ ν• (0-10000μ)
    -   [ ] XSS λ°©μ§€λ¥Ό μ„ν• μ…λ ¥ κ²€μ¦
-   [ ] κΈ°λ³Έ λ…ΈνΈ λ©λ΅ νμ΄μ§€ κµ¬ν„ (μ„μ‹)
    -   [ ] `/notes` λΌμ°νΈ μƒμ„±
    -   [ ] κΈ°λ³Έ λ μ΄μ•„μ›ƒ κµ¬ν„
    -   [ ] "μƒ λ…ΈνΈ μ‘μ„±" λ²„νΌ μ¶”κ°€
-   [ ] ν…μ¤νΈ κµ¬ν„
    -   [ ] λ…ΈνΈ μƒμ„± νΌ μ»΄ν¬λ„νΈ λ‹¨μ„ ν…μ¤νΈ
    -   [ ] λ…ΈνΈ μƒμ„± μ„λ²„ μ•΅μ… ν†µν•© ν…μ¤νΈ
    -   [ ] μ ν¨μ„± κ²€μ‚¬ ν…μ¤νΈ
    -   [ ] λ°μ΄ν„°λ² μ΄μ¤ μ—°λ™ ν…μ¤νΈ
    -   [ ] μΈμ¦ λ° κ¶ν• ν…μ¤νΈ

## Dev Notes

### μ΄μ „ μ¤ν† λ¦¬ μΈμ‚¬μ΄νΈ

[Source: Epic 1 Stories 1.1-1.3 - μ™„λ£λ κµ¬ν„ μ‚¬ν•­]

-   β… Supabase ν΄λΌμ΄μ–ΈνΈ μ„¤μ • μ™„λ£ (`lib/supabase.ts`)
-   β… μ‚¬μ©μ μΈμ¦ μ‹μ¤ν… μ™„λ£ (νμ›κ°€μ…, λ΅κ·ΈμΈ, λΉ„λ°€λ²νΈ μ¬μ„¤μ •)
-   β… shadcn/ui μ»΄ν¬λ„νΈ μ‹μ¤ν… λ„μ… (`components/ui/`)
-   β… μ„λ²„ μ•΅μ… κΈ°λ° μ•„ν‚¤ν…μ² ν™•λ¦½ (`lib/actions/auth.ts`)
-   β… νΌ μ ν¨μ„± κ²€μ‚¬ ν¨ν„΄ ν™•λ¦½ (`lib/validations/auth.ts`)
-   β… μΌκ΄€λ μ—λ¬ ν•Έλ“¤λ§ ν¨ν„΄
-   β… ν™κ²½ λ³€μ μ„¤μ • μ™„λ£

### κΈ°μ  μ¤νƒ μ •λ³΄

[Source: docs/architecture.md#1-κΈ°μ -μ¤νƒ]

-   **ν”„λ μ„μ›ν¬:** Next.js (App Router, Server Actions)
-   **UI:** shadcn/ui + Tailwind + Radix UI
-   **DB/μΈμ¦:** Supabase (Postgres, Auth, Storage)
-   **ORM:** Drizzle ORM (λ§μ΄κ·Έλ μ΄μ…/μΏΌλ¦¬)

### λ°μ΄ν„° λ¨λΈ μ„¤κ³„

[Source: docs/architecture.md#2-λ°μ΄ν„°-λ¨λΈ]

```sql
CREATE TABLE notes (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,
  title VARCHAR(200) NOT NULL,
  content TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- RLS μ •μ±…
ALTER TABLE notes ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can only access their own notes" ON notes
  FOR ALL USING (auth.uid() = user_id);
```

### λ³΄μ• μ”κµ¬μ‚¬ν•­

[Source: docs/architecture.md#3-λ³΄μ•]

-   μ‚¬μ©μ ID μ¤μ½”ν”„λ΅ κ¶ν• μ μ–΄ (RLS μ •μ±…)
-   XSS λ°©μ§€λ¥Ό μ„ν• μ…λ ¥ κ²€μ¦
-   CSRF λ³΄νΈ (Next.js Server Actions κΈ°λ³Έ μ κ³µ)
-   SQL Injection λ°©μ§€ (Drizzle ORM μ‚¬μ©)

### ν”„λ΅μ νΈ κµ¬μ΅°

-   λ…ΈνΈ μƒμ„± νμ΄μ§€: `app/notes/new/page.tsx` (μƒλ΅ μƒμ„±)
-   λ…ΈνΈ λ©λ΅ νμ΄μ§€: `app/notes/page.tsx` (κΈ°λ³Έ κµ¬ν„)
-   λ…ΈνΈ μƒμ„± νΌ: `components/notes/note-form.tsx` (μƒλ΅ μƒμ„±)
-   λ…ΈνΈ μ„λ²„ μ•΅μ…: `lib/actions/notes.ts` (μƒλ΅ μƒμ„±)
-   λ…ΈνΈ μ ν¨μ„± κ²€μ‚¬: `lib/validations/notes.ts` (μƒλ΅ μƒμ„±)
-   λ°μ΄ν„°λ² μ΄μ¤ μ¤ν‚¤λ§: `lib/db/schema.ts` (μƒλ΅ μƒμ„±)
-   λ°μ΄ν„°λ² μ΄μ¤ μ„¤μ •: `lib/db/index.ts` (μƒλ΅ μƒμ„±)

### Drizzle ORM μ„¤μ •

-   λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²° μ„¤μ •
-   μ¤ν‚¤λ§ μ •μ λ° νƒ€μ… μƒμ„±
-   λ§μ΄κ·Έλ μ΄μ… μ¤ν¬λ¦½νΈ μ„¤μ •
-   κ°λ°/ν”„λ΅λ•μ… ν™κ²½ λ¶„λ¦¬

### ν™κ²½ λ³€μ μ”κµ¬μ‚¬ν•­

[Source: Epic 1 - μ΄λ―Έ μ„¤μ • μ™„λ£]

-   β… `NEXT_PUBLIC_SUPABASE_URL`
-   β… `NEXT_PUBLIC_SUPABASE_ANON_KEY`
-   β… `SUPABASE_SERVICE_ROLE_KEY`
-   μ¶”κ°€ ν•„μ”: `DATABASE_URL` (Drizzle ORMμ©)

### UI/UX κ³ λ ¤μ‚¬ν•­

-   λ°μ‘ν• λ””μμΈ (λ¨λ°”μΌ μ°μ„ )
-   ν…μ¤νΈ μ—λ¦¬μ–΄ μλ™ λ†’μ΄ μ΅°μ 
-   μ‹¤μ‹κ°„ λ¬Έμ μ μΉ΄μ΄ν„°
-   ν‚¤λ³΄λ“ λ‹¨μ¶•ν‚¤ μ§€μ› (Ctrl+S μ €μ¥)
-   μ ‘κ·Όμ„± μ¤€μ (ARIA λ μ΄λΈ”, ν‚¤λ³΄λ“ λ„¤λΉ„κ²μ΄μ…)

### μ„±λ¥ μµμ ν™”

-   ν…μ¤νΈ μ—λ¦¬μ–΄ debounce μ²λ¦¬
-   νΌ μƒνƒ μµμ ν™”
-   λ¶ν•„μ”ν• λ¦¬λ λ”λ§ λ°©μ§€
-   μ΄λ―Έμ§€ μµμ ν™” (ν–¥ν›„ μ²¨λ¶€νμΌ κΈ°λ¥ λ€λΉ„)

### Testing

#### ν…μ¤νΈ ν‘μ¤€

[Source: docs/architecture.md#6-λ°°ν¬μ΄μ]

-   ν…μ¤νΈ ν”„λ μ„μ›ν¬: Jest + React Testing Library
-   ν…μ¤νΈ νμΌ μ„μΉ: `__tests__/` λ””λ ‰ν† λ¦¬
-   λ‹¨μ„ ν…μ¤νΈμ™€ ν†µν•© ν…μ¤νΈ λ¨λ‘ κµ¬ν„
-   λ°μ΄ν„°λ² μ΄μ¤ ν…μ¤νΈμ© λ³„λ„ ν™κ²½ κµ¬μ„±

#### νΉλ³„ ν…μ¤νΈ μΌ€μ΄μ¤

-   κΈ΄ μ λ©/λ³Έλ¬Έ μ²λ¦¬
-   νΉμ λ¬Έμ μ…λ ¥ μ²λ¦¬
-   λ„¤νΈμ›ν¬ μ¤λ¥ μ‹λ‚λ¦¬μ¤
-   λ™μ‹ μ €μ¥ μ”μ²­ μ²λ¦¬
-   κ¶ν• μ—†λ” μ‚¬μ©μ μ ‘κ·Ό μ‹λ„

### ν¨ν‚¤μ§€ μμ΅΄μ„±

μƒλ΅ μ¶”κ°€ ν•„μ”ν• ν¨ν‚¤μ§€:
-   `drizzle-orm`: ORM λΌμ΄λΈλ¬λ¦¬
-   `drizzle-kit`: λ§μ΄κ·Έλ μ΄μ… λ„κµ¬
-   `@supabase/ssr`: μ„λ²„ μ‚¬μ΄λ“ Supabase ν΄λΌμ΄μ–ΈνΈ
-   `postgres`: PostgreSQL λ“λΌμ΄λ²„

## Change Log

| Date       | Version | Description      | Author           |
| ---------- | ------- | ---------------- | ---------------- |
| 2025-09-16 | 1.0     | μ¤ν† λ¦¬ μ΄μ• μƒμ„± | Scrum Master Bob |

## Dev Agent Record

μ΄ μ„Ήμ…μ€ κ°λ° μ—μ΄μ „νΈκ°€ κµ¬ν„ μ¤‘μ— μ±„μ›μ§‘λ‹λ‹¤.

### Agent Model Used

TBD

### Debug Log References

TBD

### Completion Notes List

TBD

### File List

TBD

## QA Results

QA μ—μ΄μ „νΈκ°€ μ™„λ£λ μ¤ν† λ¦¬ κµ¬ν„μ„ κ²€ν† ν• κ²°κ³Όμ…λ‹λ‹¤.

### μ™„λ£ μΌμ

TBD

### μµμΆ… ν…μ¤νΈ κ²°κ³Ό

TBD

### κµ¬ν„ μ™„λ£λ Acceptance Criteria

TBD

